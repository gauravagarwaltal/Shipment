{"ast":null,"code":"var _jsxFileName = \"/home/gaurava/work/learning/react/shipment/src/contract/CreateInstance.js\";\nimport React from 'react';\nimport { contract_address, contract_abi } from \"./contract_config\"; // import { Web3 } from \"web3\";\n// const Tx = require('ethereumjs-tx')\n\nconst Web3 = require('web3');\n\nconst web3 = new Web3(new Web3(new Web3.providers.HttpProvider(\"http://localhost:8545\")));\nconst sideChainContract = new web3.eth.Contract(contract_abi, contract_address);\nlet details_div = \"\";\n\nconst ShowDetails = async props => {\n  // function startExit( bytes prevTx, bytes prevTxProof, uint prevTxBlkNum, bytes tx, bytes txProof, uint txBlkNum)\n  try {\n    var details = await sideChainContract.methods.getChannel(18).call();\n    console.log('Alice', details['alice']['id'], details['alice']['cash'], details['alice']['waitForInput']);\n    console.log('Bob', details['alice']['id'], details['alice']['cash'], details['alice']['waitForInput']);\n    console.log('timeout', details['timeout']);\n    console.log('status', details['status']);\n    console.log('lastCount', details['publish_tx_count']);\n    console.log('Money', details['money']);\n    details_div = 'Alice ' + details['alice']['id'] + ' ' + details['alice']['cash'] + ' ' + details['alice']['waitForInput'] + '\\n';\n    details_div += 'Bob ' + details['alice']['id'] + ' ' + details['alice']['cash'] + ' ' + details['alice']['waitForInput'] + '\\n';\n    details_div += 'timeout ' + details['timeout'] + '\\n';\n    details_div += 'status ' + details['status'] + '\\n';\n    details_div += 'lastCount ' + details['publish_tx_count'] + '\\n';\n    details_div += 'Money ' + details['money'] + '\\n';\n    console.log(details_div);\n  } catch (error) {\n    console.log(\"startExit to given contract address reverted\");\n    console.log(error);\n  }\n};\n\nconst FilterEvents = async props => {\n  let key = props.sender + \"last_fetch_block\";\n  let START_BLOCK = localStorage.getItem(key);\n  START_BLOCK = parseInt(START_BLOCK, 10);\n\n  if (Number.isNaN(START_BLOCK)) {\n    START_BLOCK = 0;\n  }\n\n  const END_BLOCK = await web3.eth.getBlockNumber();\n  localStorage.setItem(key, END_BLOCK);\n  sideChainContract.getPastEvents(\"allEvents\", {\n    fromBlock: START_BLOCK,\n    toBlock: END_BLOCK // You can also specify 'latest'\n\n  }).then(events => console.log(events)).catch(err => console.error(err));\n};\n\nconst XYZ = () => {\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"App-content\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    onClick: FilterEvents,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59\n    },\n    __self: this\n  }, \" ShowDetails\"), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60\n    },\n    __self: this\n  }, details_div)));\n};\n\nexport default XYZ;","map":{"version":3,"sources":["/home/gaurava/work/learning/react/shipment/src/contract/CreateInstance.js"],"names":["React","contract_address","contract_abi","Web3","require","web3","providers","HttpProvider","sideChainContract","eth","Contract","details_div","ShowDetails","props","details","methods","getChannel","call","console","log","error","FilterEvents","key","sender","START_BLOCK","localStorage","getItem","parseInt","Number","isNaN","END_BLOCK","getBlockNumber","setItem","getPastEvents","fromBlock","toBlock","then","events","catch","err","XYZ"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,gBAAT,EAA2BC,YAA3B,QAA+C,mBAA/C,C,CACA;AAGA;;AACA,MAAMC,IAAI,GAAGC,OAAO,CAAC,MAAD,CAApB;;AACA,MAAMC,IAAI,GAAG,IAAIF,IAAJ,CAAS,IAAIA,IAAJ,CAAS,IAAIA,IAAI,CAACG,SAAL,CAAeC,YAAnB,CAAgC,uBAAhC,CAAT,CAAT,CAAb;AAEA,MAAMC,iBAAiB,GAAG,IAAIH,IAAI,CAACI,GAAL,CAASC,QAAb,CAAsBR,YAAtB,EAAoCD,gBAApC,CAA1B;AACA,IAAIU,WAAW,GAAG,EAAlB;;AAEA,MAAMC,WAAW,GAAG,MAAOC,KAAP,IAAiB;AACjC;AACA,MAAI;AACA,QAAIC,OAAO,GAAG,MAAMN,iBAAiB,CAACO,OAAlB,CAA0BC,UAA1B,CAAqC,EAArC,EAAyCC,IAAzC,EAApB;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBL,OAAO,CAAC,OAAD,CAAP,CAAiB,IAAjB,CAArB,EAA6CA,OAAO,CAAC,OAAD,CAAP,CAAiB,MAAjB,CAA7C,EAAuEA,OAAO,CAAC,OAAD,CAAP,CAAiB,cAAjB,CAAvE;AACAI,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAmBL,OAAO,CAAC,OAAD,CAAP,CAAiB,IAAjB,CAAnB,EAA2CA,OAAO,CAAC,OAAD,CAAP,CAAiB,MAAjB,CAA3C,EAAqEA,OAAO,CAAC,OAAD,CAAP,CAAiB,cAAjB,CAArE;AACAI,IAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAuBL,OAAO,CAAC,SAAD,CAA9B;AACAI,IAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBL,OAAO,CAAC,QAAD,CAA7B;AACAI,IAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBL,OAAO,CAAC,kBAAD,CAAhC;AACAI,IAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBL,OAAO,CAAC,OAAD,CAA5B;AACAH,IAAAA,WAAW,GAAG,WAAWG,OAAO,CAAC,OAAD,CAAP,CAAiB,IAAjB,CAAX,GAAoC,GAApC,GAA0CA,OAAO,CAAC,OAAD,CAAP,CAAiB,MAAjB,CAA1C,GAAqE,GAArE,GAA2EA,OAAO,CAAC,OAAD,CAAP,CAAiB,cAAjB,CAA3E,GAA8G,IAA5H;AACAH,IAAAA,WAAW,IAAI,SAASG,OAAO,CAAC,OAAD,CAAP,CAAiB,IAAjB,CAAT,GAAkC,GAAlC,GAAwCA,OAAO,CAAC,OAAD,CAAP,CAAiB,MAAjB,CAAxC,GAAmE,GAAnE,GAAyEA,OAAO,CAAC,OAAD,CAAP,CAAiB,cAAjB,CAAzE,GAA4G,IAA3H;AACAH,IAAAA,WAAW,IAAI,aAAaG,OAAO,CAAC,SAAD,CAApB,GAAkC,IAAjD;AACAH,IAAAA,WAAW,IAAI,YAAYG,OAAO,CAAC,QAAD,CAAnB,GAAgC,IAA/C;AACAH,IAAAA,WAAW,IAAI,eAAeG,OAAO,CAAC,kBAAD,CAAtB,GAA6C,IAA5D;AACAH,IAAAA,WAAW,IAAI,WAAWG,OAAO,CAAC,OAAD,CAAlB,GAA8B,IAA7C;AACAI,IAAAA,OAAO,CAACC,GAAR,CAAYR,WAAZ;AACH,GAfD,CAeE,OAAOS,KAAP,EAAc;AACZF,IAAAA,OAAO,CAACC,GAAR,CAAY,8CAAZ;AACAD,IAAAA,OAAO,CAACC,GAAR,CAAYC,KAAZ;AACH;AACJ,CArBD;;AAuBA,MAAMC,YAAY,GAAG,MAAOR,KAAP,IAAiB;AAClC,MAAIS,GAAG,GAAGT,KAAK,CAACU,MAAN,GAAe,kBAAzB;AACA,MAAIC,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqBJ,GAArB,CAAlB;AACAE,EAAAA,WAAW,GAAGG,QAAQ,CAACH,WAAD,EAAc,EAAd,CAAtB;;AAEA,MAAII,MAAM,CAACC,KAAP,CAAaL,WAAb,CAAJ,EAA+B;AAC3BA,IAAAA,WAAW,GAAG,CAAd;AACH;;AACD,QAAMM,SAAS,GAAG,MAAMzB,IAAI,CAACI,GAAL,CAASsB,cAAT,EAAxB;AACAN,EAAAA,YAAY,CAACO,OAAb,CAAqBV,GAArB,EAA0BQ,SAA1B;AACAtB,EAAAA,iBAAiB,CAACyB,aAAlB,CAAgC,WAAhC,EACI;AACIC,IAAAA,SAAS,EAAEV,WADf;AAEIW,IAAAA,OAAO,EAAEL,SAFb,CAEuB;;AAFvB,GADJ,EAKKM,IALL,CAKUC,MAAM,IAAInB,OAAO,CAACC,GAAR,CAAYkB,MAAZ,CALpB,EAMKC,KANL,CAMYC,GAAD,IAASrB,OAAO,CAACE,KAAR,CAAcmB,GAAd,CANpB;AAQH,CAlBD;;AAmBA,MAAMC,GAAG,GAAG,MAAM;AACd,SACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAK,IAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAQ,IAAA,OAAO,EAAEnB,YAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADJ,EAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACKV,WADL,CAFJ,CADJ,CADJ;AAWH,CAZD;;AAcA,eAAe6B,GAAf","sourcesContent":["import React from 'react';\nimport { contract_address, contract_abi } from \"./contract_config\";\n// import { Web3 } from \"web3\";\n\n\n// const Tx = require('ethereumjs-tx')\nconst Web3 = require('web3')\nconst web3 = new Web3(new Web3(new Web3.providers.HttpProvider(\"http://localhost:8545\")))\n\nconst sideChainContract = new web3.eth.Contract(contract_abi, contract_address)\nlet details_div = \"\"\n\nconst ShowDetails = async (props) => {\n    // function startExit( bytes prevTx, bytes prevTxProof, uint prevTxBlkNum, bytes tx, bytes txProof, uint txBlkNum)\n    try {\n        var details = await sideChainContract.methods.getChannel(18).call()\n        console.log('Alice', details['alice']['id'], details['alice']['cash'], details['alice']['waitForInput']);\n        console.log('Bob', details['alice']['id'], details['alice']['cash'], details['alice']['waitForInput']);\n        console.log('timeout', details['timeout']);\n        console.log('status', details['status']);\n        console.log('lastCount', details['publish_tx_count']);\n        console.log('Money', details['money']);\n        details_div = 'Alice ' + details['alice']['id'] + ' ' + details['alice']['cash'] + ' ' + details['alice']['waitForInput'] + '\\n';\n        details_div += 'Bob ' + details['alice']['id'] + ' ' + details['alice']['cash'] + ' ' + details['alice']['waitForInput'] + '\\n';\n        details_div += 'timeout ' + details['timeout'] + '\\n';\n        details_div += 'status ' + details['status'] + '\\n';\n        details_div += 'lastCount ' + details['publish_tx_count'] + '\\n';\n        details_div += 'Money ' + details['money'] + '\\n';\n        console.log(details_div)\n    } catch (error) {\n        console.log(\"startExit to given contract address reverted\")\n        console.log(error)\n    }\n}\n\nconst FilterEvents = async (props) => {\n    let key = props.sender + \"last_fetch_block\"\n    let START_BLOCK = localStorage.getItem(key)\n    START_BLOCK = parseInt(START_BLOCK, 10)\n\n    if (Number.isNaN(START_BLOCK)) {\n        START_BLOCK = 0\n    }\n    const END_BLOCK = await web3.eth.getBlockNumber()\n    localStorage.setItem(key, END_BLOCK)\n    sideChainContract.getPastEvents(\"allEvents\",\n        {\n            fromBlock: START_BLOCK,\n            toBlock: END_BLOCK // You can also specify 'latest'\n        })\n        .then(events => console.log(events))\n        .catch((err) => console.error(err));\n\n}\nconst XYZ = () => {\n    return (\n        <div>\n            <div className=\"App-content\">\n                <button onClick={FilterEvents}> ShowDetails</button>\n                <div>\n                    {details_div}\n                </div>\n            </div>\n        </div>\n    );\n\n};\n\nexport default XYZ;"]},"metadata":{},"sourceType":"module"}
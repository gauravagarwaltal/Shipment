{"ast":null,"code":"import { contract_address, contract_abi } from \"./contract_config\";\n\nconst Web3 = require('web3');\n\nconst web3 = new Web3(new Web3(new Web3.providers.HttpProvider(\"http://localhost:8545\")));\nconst sideChainContract = new web3.eth.Contract(contract_abi, contract_address);\n\nconst FilterEvents = async sender => {\n  if (sender === undefined || sender === null) {\n    alert(\"Check MetaMask Connectivity\");\n  } else {\n    let key = sender + \"last_fetch_block\";\n    let START_BLOCK = localStorage.getItem(key);\n    START_BLOCK = parseInt(START_BLOCK, 10);\n\n    if (Number.isNaN(START_BLOCK)) {\n      START_BLOCK = 0;\n    }\n\n    const END_BLOCK = await web3.eth.getBlockNumber(); // localStorage.setItem(key, END_BLOCK)\n\n    console.log(START_BLOCK, END_BLOCK);\n\n    if (START_BLOCK < END_BLOCK) {\n      let events = await sideChainContract.getPastEvents(\"allEvents\", {\n        fromBlock: START_BLOCK,\n        toBlock: END_BLOCK // You can also specify 'latest'\n\n      }); // console.log(events)\n\n      return events;\n    } else {\n      console.log(\"No data to fetch\");\n      return null;\n    }\n  }\n};\n\nexport default FilterEvents;","map":{"version":3,"sources":["/home/gaurava/work/learning/react/shipment/src/contract/CreateInstance.js"],"names":["contract_address","contract_abi","Web3","require","web3","providers","HttpProvider","sideChainContract","eth","Contract","FilterEvents","sender","undefined","alert","key","START_BLOCK","localStorage","getItem","parseInt","Number","isNaN","END_BLOCK","getBlockNumber","console","log","events","getPastEvents","fromBlock","toBlock"],"mappings":"AAAA,SAASA,gBAAT,EAA2BC,YAA3B,QAA+C,mBAA/C;;AAEA,MAAMC,IAAI,GAAGC,OAAO,CAAC,MAAD,CAApB;;AACA,MAAMC,IAAI,GAAG,IAAIF,IAAJ,CAAS,IAAIA,IAAJ,CAAS,IAAIA,IAAI,CAACG,SAAL,CAAeC,YAAnB,CAAgC,uBAAhC,CAAT,CAAT,CAAb;AAEA,MAAMC,iBAAiB,GAAG,IAAIH,IAAI,CAACI,GAAL,CAASC,QAAb,CAAsBR,YAAtB,EAAoCD,gBAApC,CAA1B;;AAEA,MAAMU,YAAY,GAAG,MAAOC,MAAP,IAAkB;AACnC,MAAIA,MAAM,KAAKC,SAAX,IAAwBD,MAAM,KAAK,IAAvC,EAA6C;AACzCE,IAAAA,KAAK,CAAC,6BAAD,CAAL;AACH,GAFD,MAGK;AACD,QAAIC,GAAG,GAAGH,MAAM,GAAG,kBAAnB;AACA,QAAII,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqBH,GAArB,CAAlB;AACAC,IAAAA,WAAW,GAAGG,QAAQ,CAACH,WAAD,EAAc,EAAd,CAAtB;;AAEA,QAAII,MAAM,CAACC,KAAP,CAAaL,WAAb,CAAJ,EAA+B;AAC3BA,MAAAA,WAAW,GAAG,CAAd;AACH;;AACD,UAAMM,SAAS,GAAG,MAAMjB,IAAI,CAACI,GAAL,CAASc,cAAT,EAAxB,CARC,CASD;;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYT,WAAZ,EAAyBM,SAAzB;;AACA,QAAIN,WAAW,GAAGM,SAAlB,EAA6B;AACzB,UAAII,MAAM,GAAG,MAAMlB,iBAAiB,CAACmB,aAAlB,CAAgC,WAAhC,EACf;AACIC,QAAAA,SAAS,EAAEZ,WADf;AAEIa,QAAAA,OAAO,EAAEP,SAFb,CAEuB;;AAFvB,OADe,CAAnB,CADyB,CAMzB;;AACA,aAAOI,MAAP;AACH,KARD,MASK;AACDF,MAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ;AACA,aAAO,IAAP;AACH;AACJ;AAEJ,CA9BD;;AAgCA,eAAed,YAAf","sourcesContent":["import { contract_address, contract_abi } from \"./contract_config\";\n\nconst Web3 = require('web3')\nconst web3 = new Web3(new Web3(new Web3.providers.HttpProvider(\"http://localhost:8545\")))\n\nconst sideChainContract = new web3.eth.Contract(contract_abi, contract_address)\n\nconst FilterEvents = async (sender) => {\n    if (sender === undefined || sender === null) {\n        alert(\"Check MetaMask Connectivity\")\n    }\n    else {\n        let key = sender + \"last_fetch_block\"\n        let START_BLOCK = localStorage.getItem(key)\n        START_BLOCK = parseInt(START_BLOCK, 10)\n\n        if (Number.isNaN(START_BLOCK)) {\n            START_BLOCK = 0\n        }\n        const END_BLOCK = await web3.eth.getBlockNumber()\n        // localStorage.setItem(key, END_BLOCK)\n        console.log(START_BLOCK, END_BLOCK)\n        if (START_BLOCK < END_BLOCK) {\n            let events = await sideChainContract.getPastEvents(\"allEvents\",\n                {\n                    fromBlock: START_BLOCK,\n                    toBlock: END_BLOCK // You can also specify 'latest'\n                })\n            // console.log(events)\n            return events\n        }\n        else {\n            console.log(\"No data to fetch\")\n            return null\n        }\n    }\n\n}\n\nexport default FilterEvents;"]},"metadata":{},"sourceType":"module"}